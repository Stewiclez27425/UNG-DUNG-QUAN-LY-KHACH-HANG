{% extends "base.html" %}
{% block head %}
    <title>Dashboard Khách Hàng</title>
    <style>
        :root { --color-primary:#2563eb; --color-accent:#06b6d4; --color-support:#16a34a; --surface:#f8fafc; --surface-soft:#f1f5f9; --border:#e6eef7; --text:#1f2937; }
        .header-title { font-size: 22px; font-weight: 700; color: var(--text); }
        .header-logo { display:flex; align-items:center; gap:10px; margin-right:18px; }
        .header-logo .logo-box { width:36px; height:36px; border-radius:8px; background:var(--surface-soft); display:flex; align-items:center; justify-content:center; color:var(--color-primary); }
        .user-box { display:flex; align-items:center; background:var(--surface-soft); border:1px solid var(--border); border-radius:20px; padding:6px 14px 6px 8px; font-size:15px; font-weight:500; color:var(--color-primary); box-shadow:0 4px 14px rgba(37,99,235,.12); position:relative; z-index:2; cursor:pointer; backdrop-filter:saturate(160%) blur(4px); }
        .user-box:hover .user-dropdown { display:block; }
        .user-dropdown { display:none; position:absolute; top:44px; right:0; background:#fff; border:1px solid #e0e0e0; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,.08); min-width:180px; font-size:15px; color:var(--color-primary); padding:8px 0; z-index:1001; }
        .user-dropdown a { display:block; padding:10px 22px; color:var(--color-primary); text-decoration:none; transition:background .2s, color .2s; }
        .user-dropdown a:hover { background:var(--surface); color:#1e40af; }
        .user-avatar { width:32px; height:32px; border-radius:50%; background:#eef6ff; margin-right:8px; display:flex; align-items:center; justify-content:center; font-size:18px; color:var(--color-primary); }
        .header { position:sticky; top:0; z-index:50; display:flex; align-items:center; justify-content:space-between; margin-left:-40px; margin-right:-40px; padding:12px 40px; background:var(--surface); border-bottom:1px solid var(--border); margin-bottom:18px; box-shadow:0 2px 10px rgba(0,0,0,.03); }
        .action-bar { display:flex; justify-content:flex-end; gap:10px; margin-bottom:8px; }
        .action-bar button { padding:8px 16px; border:none; border-radius:5px; background:var(--color-primary); color:#fff; font-size:15px; cursor:pointer; transition:background .2s; }
        .action-bar button:hover { background:#1e40af; }
        .content { display:flex; gap:30px; flex-wrap:wrap; }
        .info, .history { background:#fff; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,.04); padding:24px; margin-bottom:30px; }
        .info { flex:1 1 320px; min-width:320px; }
        .history { flex:2 1 600px; min-width:600px; }
        .info h3, .history h3 { margin-top:0; color:var(--color-primary); }
        .info-table, .history-table { width:100%; border-collapse:collapse; }
        .info-table td { padding:6px 0; }
        .info-table td.label { color:#888; width:140px; }
        .history-table th, .history-table td { border-bottom:1px solid #e0e0e0; padding:8px 6px; text-align:center; vertical-align:middle; }
        .history-table th { background:#f5f6f5; color:var(--color-primary); }
        .history-statusfinish { color:#02af44; font-weight:600; }
        .history-statusunfinish { color:#e74c3c; font-weight:600; }
    </style>
{% endblock %}

{% block content %}
    <div class="header">
        <div style="display:flex; align-items:center; gap:16px;">
            <div class="header-logo">
                <div class="logo-box" aria-label="Customers">
                    <svg viewBox="0 0 24 24" width="22" height="22" fill="none">
                        <circle cx="9" cy="8" r="3" fill="#2563eb" opacity="0.9"></circle>
                        <circle cx="16" cy="9" r="2.5" fill="#2563eb" opacity="0.6"></circle>
                        <rect x="4" y="13" width="10" height="7" rx="3.5" fill="#2563eb" opacity="0.15"></rect>
                        <rect x="12.5" y="13.5" width="7" height="6.5" rx="3.25" fill="#2563eb" opacity="0.12"></rect>
                    </svg>
                </div>
                <div class="header-title">Thông tin khách hàng</div>
            </div>
        </div>
        <div class="user-box">
            <span class="user-avatar">
                <svg viewBox="0 0 24 24" fill="none"><circle cx="12" cy="8" r="4" fill="#27ae60"/><rect x="4" y="16" width="16" height="6" rx="3" fill="#27ae60" opacity=".2"/></svg>
            </span>
            {{ user_name or 'Admin' }}
            <div class="user-dropdown">
                <a href="#">Chỉnh sửa thông tin</a>
                <a href="#">Đổi mật khẩu</a>
                <a href="#">Đăng xuất</a>
            </div>
        </div>
    </div>
    <div class="action-bar">
        <button>Thêm mới</button>
        <button>Cập nhật</button>
        <button>Nhập dữ liệu</button>
        <button>Xuất dữ liệu</button>
        <button>Xóa Dữ Liệu</button>
    </div>
    <div class="content">
        <div class="info">
            <h3>Thông tin cá nhân</h3>
            <table class="info-table">
                <tr>
                    <td class="label">Tên khách hàng:</td>
                    <td>
                        {{ customer.name if customer else 'Nguyễn Phước Lộc' }}
                        <span class="customer-group-box">Thân Thiết</span>
                    </td>
                </tr>
                <tr><td class="label">Ngày sinh:</td><td>{{ customer.dob if customer else '27/09/2007' }}</td></tr>
                <tr><td class="label">Số điện thoại:</td><td>{{ customer.phone if customer else '0901234567' }}</td></tr>
                <tr><td class="label">Email:</td><td>{{ customer.email if customer else 'nploc2007@email.com' }}</td></tr>
                <tr><td class="label">Địa chỉ:</td><td>{{ customer.address if customer else 'Phan Thiết' }}</td></tr>
                <tr><td class="label">Mã KH:</td><td>{{ customer.code if customer else 'KH001' }}</td></tr>
                <tr><td class="label">Tổng tiền mua:</td><td>{{ customer.total if customer else '1,500,000đ' }}</td></tr>
                <tr><td class="label">Ngày cuối mua:</td><td>{{ customer.last_purchase if customer else '28/09/2025' }}</td></tr>
            </table>
        </div>
        <div class="history">
            <h3>Lịch sử mua hàng</h3>
            <table class="history-table">
                <tr>
                    <th>Mã đơn hàng</th>
                    <th>Tên KH</th>
                    <th>Xuất kho</th>
                    <th>Giá trị</th>
                    <th>Ngày ghi nhận</th>
                    <th>Trạng thái</th>
                </tr>
                {% for order in orders or [] %}
                <tr>
                    <td>{{ order.code }}</td>
                    <td>{{ order.customer }}</td>
                    <td>{{ order.export_status }}</td>
                    <td>{{ order.value }}</td>
                    <td>{{ order.date }}</td>
                    <td class="{{ 'history-statusfinish' if order.status == 'done' else 'history-statusunfinish' }}">{{ order.status_label }}</td>
                </tr>
                {% endfor %}
            </table>
            {% if orders %}
            <div style="margin-bottom:12px; color:#675c5c; font-size:14px;">Hiển thị {{ orders|length }}/{{ orders|length }} kết quả</div>
            {% endif %}
        </div>
    </div>
{% endblock %}


